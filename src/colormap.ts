// Copyright 2021 Charles Dueck

// ColorMap converts a number in [0, 1] to a CSS style of a color.
export interface ColorMap {
    (x: number): string;
};

// Taken from https://github.com/BIDS/colormap/blob/bc549477db0c12b54a5928087552ad2cf274980f/colormaps.py
const viridisData = [
    "#440154",
    "#440255",
    "#450357",
    "#450558",
    "#45065A",
    "#46085B",
    "#46095D",
    "#460B5E",
    "#460C60",
    "#470E61",
    "#470F62",
    "#471164",
    "#471265",
    "#471466",
    "#481568",
    "#481669",
    "#48186A",
    "#48196C",
    "#481A6D",
    "#481C6E",
    "#481D6F",
    "#481E70",
    "#482071",
    "#482173",
    "#482274",
    "#482475",
    "#482576",
    "#482677",
    "#482778",
    "#472979",
    "#472A79",
    "#472B7A",
    "#472C7B",
    "#472E7C",
    "#462F7D",
    "#46307E",
    "#46317E",
    "#46337F",
    "#453480",
    "#453581",
    "#453681",
    "#443882",
    "#443983",
    "#443A83",
    "#433B84",
    "#433C84",
    "#433E85",
    "#423F85",
    "#424086",
    "#414186",
    "#414287",
    "#414387",
    "#404588",
    "#404688",
    "#3F4788",
    "#3F4889",
    "#3E4989",
    "#3E4A89",
    "#3D4B8A",
    "#3D4D8A",
    "#3C4E8A",
    "#3C4F8A",
    "#3B508B",
    "#3B518B",
    "#3A528B",
    "#3A538B",
    "#39548C",
    "#39558C",
    "#38568C",
    "#38578C",
    "#37588C",
    "#37598C",
    "#365B8D",
    "#365C8D",
    "#355D8D",
    "#355E8D",
    "#345F8D",
    "#34608D",
    "#33618D",
    "#33628D",
    "#33638D",
    "#32648E",
    "#32658E",
    "#31668E",
    "#31678E",
    "#30688E",
    "#30698E",
    "#2F6A8E",
    "#2F6B8E",
    "#2F6C8E",
    "#2E6D8E",
    "#2E6E8E",
    "#2D6F8E",
    "#2D708E",
    "#2D708E",
    "#2C718E",
    "#2C728E",
    "#2B738E",
    "#2B748E",
    "#2B758E",
    "#2A768E",
    "#2A778E",
    "#29788E",
    "#29798E",
    "#297A8E",
    "#287B8E",
    "#287C8E",
    "#287D8E",
    "#277E8E",
    "#277F8E",
    "#26808E",
    "#26818E",
    "#26828E",
    "#25838E",
    "#25838E",
    "#25848E",
    "#24858E",
    "#24868E",
    "#23878E",
    "#23888E",
    "#23898E",
    "#228A8D",
    "#228B8D",
    "#228C8D",
    "#218D8D",
    "#218E8D",
    "#218F8D",
    "#20908D",
    "#20918C",
    "#20928C",
    "#20938C",
    "#1F938C",
    "#1F948C",
    "#1F958B",
    "#1F968B",
    "#1F978B",
    "#1E988B",
    "#1E998A",
    "#1E9A8A",
    "#1E9B8A",
    "#1E9C89",
    "#1E9D89",
    "#1E9E89",
    "#1E9F88",
    "#1EA088",
    "#1FA188",
    "#1FA287",
    "#1FA387",
    "#1FA386",
    "#20A486",
    "#20A586",
    "#21A685",
    "#21A785",
    "#22A884",
    "#23A983",
    "#23AA83",
    "#24AB82",
    "#25AC82",
    "#26AD81",
    "#27AE81",
    "#28AF80",
    "#29AF7F",
    "#2AB07F",
    "#2BB17E",
    "#2CB27D",
    "#2EB37C",
    "#2FB47C",
    "#30B57B",
    "#32B67A",
    "#33B779",
    "#35B779",
    "#36B878",
    "#38B977",
    "#39BA76",
    "#3BBB75",
    "#3DBC74",
    "#3EBD73",
    "#40BE72",
    "#42BE71",
    "#44BF70",
    "#46C06F",
    "#48C16E",
    "#49C26D",
    "#4BC26C",
    "#4DC36B",
    "#4FC46A",
    "#51C569",
    "#53C668",
    "#55C666",
    "#58C765",
    "#5AC864",
    "#5CC963",
    "#5EC962",
    "#60CA60",
    "#62CB5F",
    "#65CC5E",
    "#67CC5C",
    "#69CD5B",
    "#6CCE5A",
    "#6ECE58",
    "#70CF57",
    "#73D055",
    "#75D054",
    "#77D152",
    "#7AD251",
    "#7CD24F",
    "#7FD34E",
    "#81D44C",
    "#84D44B",
    "#86D549",
    "#89D548",
    "#8BD646",
    "#8ED744",
    "#90D743",
    "#93D841",
    "#95D83F",
    "#98D93E",
    "#9BD93C",
    "#9DDA3A",
    "#A0DA39",
    "#A3DB37",
    "#A5DB35",
    "#A8DC33",
    "#ABDC32",
    "#ADDD30",
    "#B0DD2E",
    "#B3DD2D",
    "#B5DE2B",
    "#B8DE29",
    "#BBDF27",
    "#BDDF26",
    "#C0DF24",
    "#C3E023",
    "#C5E021",
    "#C8E120",
    "#CBE11E",
    "#CDE11D",
    "#D0E21C",
    "#D3E21B",
    "#D5E21A",
    "#D8E319",
    "#DBE318",
    "#DDE318",
    "#E0E418",
    "#E2E418",
    "#E5E418",
    "#E8E519",
    "#EAE519",
    "#EDE51A",
    "#EFE61B",
    "#F2E61C",
    "#F4E61E",
    "#F7E61F",
    "#F9E721",
    "#FBE723",
    "#FEE724",
];

export function viridis(x: number): string {
    const i = Math.max(0, Math.min(Math.floor(x * 256), 255));
    return viridisData[i];
}

export function linearGradient(ctx: CanvasRenderingContext2D, cm: ColorMap, stops: number, x0: number, y0: number, x1: number, y1: number): CanvasGradient {
    const g = ctx.createLinearGradient(x0, y0, x1, y1);
    for (let i = 0; i < stops; i++) {
        const stop = i / (stops - 1);
        g.addColorStop(stop, cm(stop));
    }
    return g;
}
