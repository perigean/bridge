// Copyright Charles Dueck 2020
import { Viewport, PanGesture, PinchZoomGesture } from "./viewport.js";
import { TouchDemux } from "./touch.js";
import { Gestures } from "./gesture.js";
import { trussMethod, trussRenderer } from "./truss.js";
const c = document.getElementById("canvas");
if (c === null) {
    throw new Error("No canvas element");
}
const ctx = c.getContext("2d");
if (ctx === null) {
    throw new Error("No 2d context");
}
//     0 - 1 - 2
//   / | \ | / | \
// 6 - 3 - 4 - 5 - 7
const truss = {
    pins: [
        [-5.0, 5.0],
        [0.0, 5.0],
        [5.0, 5.0],
        [-5.0, 0.0],
        [0.0, 0.0],
        [5.0, 0.0],
        [-10.0, 0.0],
        [10.0, 0.0],
    ],
    mobilePins: 6,
    beams: [
        { p1: 0, p2: 1, m: 0, w: 0.1 },
        { p1: 1, p2: 2, m: 0, w: 0.1 },
        { p1: 6, p2: 0, m: 0, w: 0.1 },
        { p1: 3, p2: 0, m: 0, w: 0.1 },
        { p1: 4, p2: 0, m: 0, w: 0.1 },
        { p1: 4, p2: 1, m: 0, w: 0.1 },
        { p1: 4, p2: 2, m: 0, w: 0.1 },
        { p1: 5, p2: 2, m: 0, w: 0.1 },
        { p1: 7, p2: 2, m: 0, w: 0.1 },
        { p1: 6, p2: 3, m: 0, w: 0.1 },
        { p1: 3, p2: 4, m: 0, w: 0.1 },
        { p1: 4, p2: 5, m: 0, w: 0.1 },
        { p1: 5, p2: 7, m: 0, w: 0.1 },
    ],
    materials: [
        {
            E: 20000000.0,
            style: "black",
            density: 1200.0,
        },
    ],
    g: [0.0, -9.8],
};
// 2 - 0 - 1
/*
const truss: Truss = {
    pins: [
        [0.0, 0.0],
        [5.0, 0.0],
        [-5.0, 0.0],
    ],
    mobilePins: 1,
    beams: [
        { p1: 0, p2: 1, m: 0, w: 0.1 },
        { p1: 0, p2: 2, m: 0, w: 0.1 },
    ],
    materials: [
        {   // Rubber.
            E: 50000.0,
            style: "black",
            density: 1200.0,
         },
    ],
    g: [0.0, -1.0], // TODO: move up to scene level, when that exists.
};
*/
// TODO: main loop should be calls to render, plus request to async compute next physics step.
const ode = trussMethod(truss);
const render = trussRenderer(truss);
const vp = new Viewport(ctx, (_b, _s, ctx) => {
    render(ctx, ode);
});
function mainLoop(_now) {
    for (let i = 0; i < 10; i++) {
        ode.next(0.016666666);
    }
    vp.requestRedraw();
    requestAnimationFrame(mainLoop);
}
requestAnimationFrame(mainLoop);
function clip(v, min, max) {
    return Math.min(max, Math.max(min, v));
}
vp.setClipPosition((p) => {
    p.scale = clip(p.scale, 10.0, 1000.0);
    p.pos[0] = clip(p.pos[0], -256, 256);
    p.pos[1] = clip(p.pos[1], -256, 256);
    return p;
});
window.addEventListener("resize", vp.resize);
const touch = new TouchDemux(c);
const gesture = new Gestures();
touch.addTouchHandler(gesture);
gesture.addGestureHandler(new PanGesture(vp));
gesture.addGestureHandler(new PinchZoomGesture(vp));
// TODO: mouse and trackpad input
// scroll
// scroll wheel zoom in and out
// what to rotate? right click drag, rotate around center of vp? Maybe don't care, since bridge wont use rotate
console.log("stuff loaded");
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoibWFpbi5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uL3NyYy9tYWluLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLCtCQUErQjtBQUUvQixPQUFPLEVBQUUsUUFBUSxFQUFvQixVQUFVLEVBQUUsZ0JBQWdCLEVBQUUsTUFBTSxlQUFlLENBQUE7QUFDeEYsT0FBTyxFQUFFLFVBQVUsRUFBRSxNQUFNLFlBQVksQ0FBQTtBQUN2QyxPQUFPLEVBQUUsUUFBUSxFQUFDLE1BQU0sY0FBYyxDQUFBO0FBQ3RDLE9BQU8sRUFBRSxXQUFXLEVBQUUsYUFBYSxFQUFTLE1BQU0sWUFBWSxDQUFDO0FBRS9ELE1BQU0sQ0FBQyxHQUFJLFFBQVEsQ0FBQyxjQUFjLENBQUMsUUFBUSxDQUF1QixDQUFDO0FBQ25FLElBQUksQ0FBQyxLQUFLLElBQUksRUFBRTtJQUNaLE1BQU0sSUFBSSxLQUFLLENBQUMsbUJBQW1CLENBQUMsQ0FBQztDQUN4QztBQUNELE1BQU0sR0FBRyxHQUFHLENBQUMsQ0FBQyxVQUFVLENBQUMsSUFBSSxDQUFDLENBQUM7QUFDL0IsSUFBSSxHQUFHLEtBQUssSUFBSSxFQUFFO0lBQ2QsTUFBTSxJQUFJLEtBQUssQ0FBQyxlQUFlLENBQUMsQ0FBQztDQUNwQztBQUVELGdCQUFnQjtBQUNoQixrQkFBa0I7QUFDbEIsb0JBQW9CO0FBRXBCLE1BQU0sS0FBSyxHQUFVO0lBQ2pCLElBQUksRUFBRTtRQUNGLENBQUMsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ1gsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ1YsQ0FBQyxHQUFHLEVBQUUsR0FBRyxDQUFDO1FBQ1YsQ0FBQyxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDWCxDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDVixDQUFDLEdBQUcsRUFBRSxHQUFHLENBQUM7UUFDVixDQUFDLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQztRQUNaLENBQUMsSUFBSSxFQUFFLEdBQUcsQ0FBQztLQUNkO0lBQ0QsVUFBVSxFQUFFLENBQUM7SUFDYixLQUFLLEVBQUU7UUFDSCxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxHQUFHLEVBQUU7UUFDOUIsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsR0FBRyxFQUFFO1FBQzlCLEVBQUUsRUFBRSxFQUFFLENBQUMsRUFBRSxFQUFFLEVBQUUsQ0FBQyxFQUFFLENBQUMsRUFBRSxDQUFDLEVBQUUsQ0FBQyxFQUFFLEdBQUcsRUFBRTtRQUM5QixFQUFFLEVBQUUsRUFBRSxDQUFDLEVBQUUsRUFBRSxF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LFVBQVUsQ0FBQyxFQUFFLENBQUMsQ0FBQyxDQUFDO0FBQzlDLE9BQU8sQ0FBQyxpQkFBaUIsQ0FBQyxJQUFJLGdCQUFnQixDQUFDLEVBQUUsQ0FBQyxDQUFDLENBQUM7QUFFcEQsaUNBQWlDO0FBQ2pDLFNBQVM7QUFDVCwrQkFBK0I7QUFDL0IsK0dBQStHO0FBRS9HLE9BQU8sQ0FBQyxHQUFHLENBQUMsY0FBYyxDQUFDLENBQUMiLCJzb3VyY2VzQ29udGVudCI6WyIvLyBDb3B5cmlnaHQgQ2hhcmxlcyBEdWVjayAyMDIwXG5cbmltcG9ydCB7IFZpZXdwb3J0LCBWaWV3cG9ydFBvc2l0aW9uLCBQYW5HZXN0dXJlLCBQaW5jaFpvb21HZXN0dXJlIH0gZnJvbSBcIi4vdmlld3BvcnQuanNcIlxuaW1wb3J0IHsgVG91Y2hEZW11eCB9IGZyb20gXCIuL3RvdWNoLmpzXCJcbmltcG9ydCB7IEdlc3R1cmVzfSBmcm9tIFwiLi9nZXN0dXJlLmpzXCJcbmltcG9ydCB7IHRydXNzTWV0aG9kLCB0cnVzc1JlbmRlcmVyLCBUcnVzcyB9IGZyb20gXCIuL3RydXNzLmpzXCI7XG5cbmNvbnN0IGMgPSAoZG9jdW1lbnQuZ2V0RWxlbWVudEJ5SWQoXCJjYW52YXNcIikgYXMgSFRNTENhbnZhc0VsZW1lbnQpO1xuaWYgKGMgPT09IG51bGwpIHtcbiAgICB0aHJvdyBuZXcgRXJyb3IoXCJObyBjYW52YXMgZWxlbWVudFwiKTtcbn1cbmNvbnN0IGN0eCA9IGMuZ2V0Q29udGV4dChcIjJkXCIpO1xuaWYgKGN0eCA9PT0gbnVsbCkge1xuICAgIHRocm93IG5ldyBFcnJvcihcIk5vIDJkIGNvbnRleHRcIik7XG59XG5cbi8vICAgICAwIC0gMSAtIDJcbi8vICAgLyB8IFxcIHwgLyB8IFxcXG4vLyA2IC0gMyAtIDQgLSA1IC0gN1xuXG5jb25zdCB0cnVzczogVHJ1c3MgPSB7XG4gICAgcGluczogW1xuICAgICAgICBbLTUuMCwgNS4wXSxcbiAgICAgICAgWzAuMCwgNS4wXSxcbiAgICAgICAgWzUuMCwgNS4wXSxcbiAgICAgICAgWy01LjAsIDAuMF0sXG4gICAgICAgIFswLjAsIDAuMF0sXG4gICAgICAgIFs1LjAsIDAuMF0sXG4gICAgICAgIFstMTAuMCwgMC4wXSxcbiAgICAgICAgWzEwLjAsIDAuMF0sXG4gICAgXSxcbiAgICBtb2JpbGVQaW5zOiA2LFxuICAgIGJlYW1zOiBbXG4gICAgICAgIHsgcDE6IDAsIHAyOiAxLCBtOiAwLCB3OiAwLjEgfSxcbiAgICAgICAgeyBwMTogMSwgcDI6IDIsIG06IDAsIHc6IDAuMSB9LFxuICAgICAgICB7IHAxOiA2LCBwMjogMCwgbTogMCwgdzogMC4xIH0sXG4gICAgICAgIHsgcDE6IDMsIHAyOiAwLCBtOiAwLCB3OiAwLjEgfSxcbiAgICAgICAgeyBwMTogNCwgcDI6IDAsIG06IDAsIHc6IDAuMSB9LFxuICAgICAgICB7IHAxOiA0LCBwMjogMSwgbTogMCwgdzogMC4xIH0sXG4gICAgICAgIHsgcDE6IDQsIHAyOiAyLCBtOiAwLCB3OiAwLjEgfSxcbiAgICAgICAgeyBwMTogNSwgcDI6IDIsIG06IDAsIHc6IDAuMSB9LFxuICAgICAgICB7IHAxOiA3LCBwMjogMiwgbTogMCwgdzogMC4xIH0sXG4gICAgICAgIHsgcDE6IDYsIHAyOiAzLCBtOiAwLCB3OiAwLjEgfSxcbiAgICAgICAgeyBwMTogMywgcDI6IDQsIG06IDAsIHc6IDAuMSB9LFxuICAgICAgICB7IHAxOiA0LCBwMjogNSwgbTogMCwgdzogMC4xIH0sXG4gICAgICAgIHsgcDE6IDUsIHAyOiA3LCBtOiAwLCB3OiAwLjEgfSxcbiAgICBdLFxuICAgIG1hdGVyaWFsczogW1xuICAgICAgICB7ICAgLy8gUnViYmVyLlxuICAgICAgICAgICAgRTogMjAwMDAwMDAuMCxcbiAgICAgICAgICAgIHN0eWxlOiBcImJsYWNrXCIsXG4gICAgICAgICAgICBkZW5zaXR5OiAxMjAwLjAsXG4gICAgICAgICB9LFxuICAgIF0sXG4gICAgZzogWzAuMCwgLTkuOF0sIC8vIFRPRE86IG1vdmUgdXAgdG8gc2NlbmUgbGV2ZWwsIHdoZW4gdGhhdCBleGlzdHMuXG59O1xuXG5cbi8vIDIgLSAwIC0gMVxuLypcbmNvbnN0IHRydXNzOiBUcnVzcyA9IHtcbiAgICBwaW5zOiBbXG4gICAgICAgIFswLjAsIDAuMF0sXG4gICAgICAgIFs1LjAsIDAuMF0sXG4gICAgICAgIFstNS4wLCAwLjBdLFxuICAgIF0sXG4gICAgbW9iaWxlUGluczogMSxcbiAgICBiZWFtczogW1xuICAgICAgICB7IHAxOiAwLCBwMjogMSwgbTogMCwgdzogMC4xIH0sXG4gICAgICAgIHsgcDE6IDAsIHAyOiAyLCBtOiAwLCB3OiAwLjEgfSxcbiAgICBdLFxuICAgIG1hdGVyaWFsczogW1xuICAgICAgICB7ICAgLy8gUnViYmVyLlxuICAgICAgICAgICAgRTogNTAwMDAuMCxcbiAgICAgICAgICAgIHN0eWxlOiBcImJsYWNrXCIsXG4gICAgICAgICAgICBkZW5zaXR5OiAxMjAwLjAsXG4gICAgICAgICB9LFxuICAgIF0sXG4gICAgZzogWzAuMCwgLTEuMF0sIC8vIFRPRE86IG1vdmUgdXAgdG8gc2NlbmUgbGV2ZWwsIHdoZW4gdGhhdCBleGlzdHMuXG59O1xuKi9cbi8vIFRPRE86IG1haW4gbG9vcCBzaG91bGQgYmUgY2FsbHMgdG8gcmVuZGVyLCBwbHVzIHJlcXVlc3QgdG8gYXN5bmMgY29tcHV0ZSBuZXh0IHBoeXNpY3Mgc3RlcC5cblxuY29uc3Qgb2RlID0gdHJ1c3NNZXRob2QodHJ1c3MpO1xuY29uc3QgcmVuZGVyID0gdHJ1c3NSZW5kZXJlcih0cnVzcyk7XG5cbmNvbnN0IHZwID0gbmV3IFZpZXdwb3J0KGN0eCwgKF9iLCBfcywgY3R4OiBDYW52YXNSZW5kZXJpbmdDb250ZXh0MkQpID0+IHtcbiAgICByZW5kZXIoY3R4LCBvZGUpO1xufSk7XG5cbmZ1bmN0aW9uIG1haW5Mb29wKF9ub3c6IERPTUhpZ2hSZXNUaW1lU3RhbXApIHtcbiAgICBmb3IgKGxldCBpID0gMDsgaSA8IDEwOyBpKyspIHtcbiAgICAgICAgb2RlLm5leHQoMC4wMTY2NjY2NjYpO1xuICAgIH1cbiAgICB2cC5yZXF1ZXN0UmVkcmF3KCk7XG4gICAgcmVxdWVzdEFuaW1hdGlvbkZyYW1lKG1haW5Mb29wKTtcbn1cbnJlcXVlc3RBbmltYXRpb25GcmFtZShtYWluTG9vcCk7XG5cblxuZnVuY3Rpb24gY2xpcCh2OiBudW1iZXIsIG1pbjogbnVtYmVyLCBtYXg6IG51bWJlcik6IG51bWJlciB7XG4gICAgcmV0dXJuIE1hdGgubWluKG1heCwgTWF0aC5tYXgobWluLCB2KSk7XG59XG5cbnZwLnNldENsaXBQb3NpdGlvbigocDogVmlld3BvcnRQb3NpdGlvbik6IFZpZXdwb3J0UG9zaXRpb24gPT4ge1xuICAgIHAuc2NhbGUgPSBjbGlwKHAuc2NhbGUsIDEwLjAsIDEwMDAuMCk7XG4gICAgcC5wb3NbMF0gPSBjbGlwKHAucG9zWzBdLCAtMjU2LCAyNTYpO1xuICAgIHAucG9zWzFdID0gY2xpcChwLnBvc1sxXSwgLTI1NiwgMjU2KTtcbiAgICByZXR1cm4gcDtcbn0pO1xuXG53aW5kb3cuYWRkRXZlbnRMaXN0ZW5lcihcInJlc2l6ZVwiLCB2cC5yZXNpemUpO1xuXG5jb25zdCB0b3VjaCA9IG5ldyBUb3VjaERlbXV4KGMpO1xuY29uc3QgZ2VzdHVyZSA9IG5ldyBHZXN0dXJlcygpO1xudG91Y2guYWRkVG91Y2hIYW5kbGVyKGdlc3R1cmUpO1xuZ2VzdHVyZS5hZGRHZXN0dXJlSGFuZGxlcihuZXcgUGFuR2VzdHVyZSh2cCkpO1xuZ2VzdHVyZS5hZGRHZXN0dXJlSGFuZGxlcihuZXcgUGluY2hab29tR2VzdHVyZSh2cCkpO1xuXG4vLyBUT0RPOiBtb3VzZSBhbmQgdHJhY2twYWQgaW5wdXRcbi8vIHNjcm9sbFxuLy8gc2Nyb2xsIHdoZWVsIHpvb20gaW4gYW5kIG91dFxuLy8gd2hhdCB0byByb3RhdGU/IHJpZ2h0IGNsaWNrIGRyYWcsIHJvdGF0ZSBhcm91bmQgY2VudGVyIG9mIHZwPyBNYXliZSBkb24ndCBjYXJlLCBzaW5jZSBicmlkZ2Ugd29udCB1c2Ugcm90YXRlXG5cbmNvbnNvbGUubG9nKFwic3R1ZmYgbG9hZGVkXCIpO1xuIl19